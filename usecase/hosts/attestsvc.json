{
    "vars": {
        "id": "attestsvc",
        "services": [ "waitdb", "copykey", "webapi" ],
        "default_targets": [ "setup-waitdb", "setup-copykey", "start-services" ],
        "webapi_app": "/hcp/example1/attestsvc.py",
        "webapi_fqdn": "attestsvc.hcphacking.xyz",
        "webapi_port": 443,
        "webapi_https_authentication": "none",
        "webapi_https_certificate": "/cred_attestsvc"
    },
    "args_for": "attestsvc",

    "scope": [
        { "load": ".defaults", "path": "/usecase/proto/defaults.json" },
        { "vars": ".defaults" },
        { "import": ".", "source": "." },
        { "vars": ".vars" },
        { "loadunion": ".", "path": "/usecase/proto/root.json" },
        { "load": ".webapi", "path": "/usecase/proto/webapi.json" }
    ],

    "waitdb": {
        "setup": [ {
            "tag": "waitdb",
            "exec": [ "/hcp/python/HcpToolWaitTouchfile.py", "/example/.db-created" ],
            "touchfile": "/example/.db-created"
        } ]
    },

    "copykey": {
        "setup": [ {
            "tag": "copykey",
            "exec": [ "bash", "-c",
                "cp /key_attestnoncer /tmp/www-data-noncekey && cp /signer_asset /tmp/www-data-signer && chown www-data /tmp/www-data-* && touch /tmp/www-data.copied"],
            "touchfile": "/tmp/www-data.copied"
        } ]
    },

    "example1": {
        "_": "The hooks in hcp/example1/attestsvc will consume these.",
        "cacert": "/ca_default",
        "clientcert": "/cred_kdcclient"
    }
}
